# Ralph Progress Log
# Feature: Ralph Wiggum Meme Generator
# Branch: ralph/meme-generator
# Started: 2026-01-21

## Codebase Patterns
- Use `// @ts-check` at top of JS files for TypeScript checking
- Use `/// <reference types="fabric" />` for Fabric.js type hints
- Use JSDoc comments for type annotations in JavaScript
- Fabric.js is loaded via CDN, access global `fabric` object
- Run `npm run typecheck` to verify code
- Canvas is exposed on `window.canvas` for testing access
- Use playwright with `node test-addtext.mjs` for browser testing

---

## 2026-01-21 - US-001
- Implemented project scaffolding with HTML, CSS, and Fabric.js
- Files created:
  - index.html: Two-panel layout with canvas (left) and controls (right)
  - styles.css: Dark theme with CSS custom properties
  - app.js: Fabric.js canvas initialization (512x512, gray background)
  - package.json: npm package with typecheck script
  - tsconfig.json: TypeScript config for JS checking
- **Learnings for future iterations:**
  - Fabric.js CDN version 5.3.1 is used
  - Google Fonts included: Bangers and Permanent Marker
  - Canvas size is 512x512 pixels matching z-image output
  - Use `fabricLib` variable to reference the global fabric object with types
  - Type checking enabled with `tsc --noEmit`
---

## 2026-01-21 - US-002
- Implemented prompt input and z-image integration
- Files modified:
  - index.html: Added textarea for prompt, Generate button, loading indicator, error message div
  - styles.css: Added .hidden, .loading-indicator, .spinner (with animation), .error-message styles
  - app.js: Added generateImage(), showLoading/hideLoading(), showError/hideError(), setBackgroundImage() functions
- **Learnings for future iterations:**
  - Background image stored in global `backgroundImage` variable for future reference/removal
  - z-image API expects POST with JSON body `{ prompt: string }`, returns `{ image: base64 }` or `{ url: string }`
  - Use `fabricLib.Image.fromURL()` to load images, with `{ crossOrigin: 'anonymous' }` option
  - Background images are non-selectable (`selectable: false, evented: false`) and sent to back
  - CONFIG object at top of app.js holds endpoint URL for easy configuration
---

## 2026-01-21 - US-003
- Implemented "Add text box to canvas" feature
- Files modified:
  - index.html: Added "Text" section with "Add Text" button
  - app.js: Added addTextBox() function, exposed canvas on window for testing
  - package.json: Added playwright as dev dependency for browser testing
- Files created:
  - test-addtext.mjs: Playwright test for text box functionality
- **Learnings for future iterations:**
  - Use `fabricLib.IText` for editable text boxes (supports inline editing)
  - Text boxes are centered with `originX: 'center', originY: 'center'`
  - Use `canvas.setActiveObject(obj)` to auto-select newly created objects
  - Canvas needs to be exposed on `window.canvas` for playwright tests to access it
  - Playwright tests work well with `page.evaluate()` for canvas state verification
---

